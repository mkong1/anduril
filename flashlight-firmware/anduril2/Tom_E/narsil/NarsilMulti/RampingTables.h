/****************************************************************************************
 * RampingTables.h
 * ===============
 *
 ****************************************************************************************/

#ifndef RAMPINGTABLES_H_
#define RAMPINGTABLES_H_



//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------
#if   OUT_CHANNELS == 2			// FET+1 or Buck driver
//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------

	//----------------------------------------------------
	// Ramping Mode Levels, 150 total entries (2.4 secs)
	//----------------------------------------------------
	#if USING_3807135_BANK
	//---------------------------------------------------------------------------------------
		#define RAMP_SIZE  150
		#define FET_START_LVL 68

		#define TIMED_STEPDOWN_MIN 115	// min level in ramping the timed stepdown will engage,
		//    level 115 = 110 PWM, this is ~43% (for 350's)
		#define TIMED_STEPDOWN_SET 102	// the level timed stepdown will set,
		//    level 102 = 72 PWM, this is ~32% (for 350's)

		// For MtnE 32x7135 380 driver (slight delay at transition point):
		//    level_calc.py 2 150 7135 5 0.3 180 7135 5 1 1500
		PROGMEM const byte ramp_7135[] = {
			5,5,5,6,6,6,7,7,						 7,8,9,9,10,11,12,13,					// 1..16
			14,15,16,17,19,20,22,24,			 26,28,30,32,34,37,40,42,
			45,48,51,55,58,62,66,70,			 74,78,83,88,92,98,103,108,
			114,120,126,132,139,145,152,159,	 167,174,182,190,199,207,216,225,
			235,244,255,255,255,255,255,255,	 255,255,255,255,255,255,255,255,	// edited 254-->255 for entry #67 (1 based)
			255,255,255,255,255,255,255,255,	 255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	 255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	 255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	 255,255,255,255,255,255,255,255,	// 129..144
			255,255,255,255,255,255																// 145..150
		};

		PROGMEM const byte ramp_FET[]  = {
			0,0,0,0,0,0,0,0,						 0,0,0,0,0,0,0,0,							// 1..16
			0,0,0,0,0,0,0,0,						 0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						 0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						 0,0,0,0,0,0,0,0,
			0,0,0,6,7,8,10,11,					 12,14,15,17,18,20,22,23,				// starts at entry 68
			25,27,28,30,32,34,36,38,			 40,42,44,46,48,50,52,55,
			57,59,62,64,67,69,72,75,			 77,80,83,86,89,91,94,97,
			101,104,107,110,113,117,120,124,	 127,131,134,138,142,146,150,153,
			157,161,166,170,174,178,182,187,	 191,196,200,205,210,215,219,224,	// 129..144
			229,234,239,244,250,255																// 145..150
		};
	//---------------------------------------------------------------------------------------

	#else // regular FET+1 or Buck support

	  #ifdef GT_BUCK
		//---------------------------------------------------------------------
		//  Buck driver 2 channel modes
		//---------------------------------------------------------------------
		#define RAMP_SIZE  132
		#define FET_START_LVL 53

		#define TIMED_STEPDOWN_MIN 113	// min level in ramping the timed stepdown will engage,
		//    level 113 = 108 PWM, this is 1.01 amps
		#define TIMED_STEPDOWN_SET 100	// the level timed stepdown will set,
		//    level 100 = 76 PWM, this is 0.66 amps

		// For GT-Buck, 2.5 A
		PROGMEM const byte ramp_7135[] = {
			6,7,8,10,11,12,14,15,				17,19,21,23,25,27,30,32,
			35,38,41,44,48,51,55,59,			63,68,72,77,82,87,92,98,
			103,109,115,122,128,135,142,150,	157,165,173,182,191,199,209,218,
			228,238,248,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255
		};

		PROGMEM const byte ramp_FET[]  = {
			25,25,25,25,25,25,25,25,			25,25,25,25,25,25,25,25,
			25,25,25,25,25,25,25,25,			25,25,25,25,25,25,25,25,
			25,25,25,25,25,25,25,25,			25,25,25,25,25,25,25,25,
			25,25,25,25,26,26,27,27,			28,28,29,30,30,31,32,32,
			33,34,34,35,36,37,38,38,			39,40,41,42,43,44,45,46,
			47,49,50,51,52,53,55,56,			58,59,60,62,64,65,67,69,
			70,72,74,76,78,80,82,84,			87,89,91,94,96,99,102,105,
			108,111,114,118,121,125,129,133,	137,141,146,151,156,161,167,173,
			179,186,193,201
		};
	  #else
		//---------------------------------------------------------------------
		//  Standard FET+1 2 channel modes
		//---------------------------------------------------------------------
		//#define RAMP_SIZE  130	// for using TURBO_LEVEL_SUPPORT
		#define RAMP_SIZE  150
		#define FET_START_LVL 66

		#define TIMED_STEPDOWN_MIN 115	// min level in ramping the timed stepdown will engage,
		//    level 115 = 110 PWM, this is ~43% (for 350's)
		#define TIMED_STEPDOWN_SET 102	// the level timed stepdown will set,
		//    level 102 = 72 PWM, this is ~32% (for 350's)

		// For FET+1: FET and one 350 mA 7135 (tested/verified to be smooth):
		//    level_calc.py 2 150 7135 3 0.3 150 FET 1 1 1500
		PROGMEM const byte ramp_7135[] = {
			3,3,3,4,4,4,5,5,  6,6,7,8,9,10,11,12,
			13,14,15,17,18,20,22,24,  26,28,30,33,35,38,41,44,
			47,51,54,58,62,66,70,74,  79,83,88,93,99,104,110,116,
			122,128,135,142,149,156,164,172,  180,188,196,205,214,223,233,243,	// 49-64
			253,255,255,255,255,255,255,255,  255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,  255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,  255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,  255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,  255,255,255,255,255,255,255,255,
			255,255,255,255,255,0																// 145-150
		};

		PROGMEM const byte ramp_FET[]  = {
			0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,												// 49-64
			0,2,3,4,5,7,8,9,  11,12,14,15,17,18,20,22,
			23,25,27,29,30,32,34,36,  38,40,42,44,47,49,51,53,
			56,58,60,63,66,68,71,73,  76,79,82,85,87,90,93,96,							// 97-112
			100,103,106,109,113,116,119,123,  126,130,134,137,141,145,149,153,	// 113-128
			157,161,165,169,173,178,182,186,  191,196,200,205,210,214,219,224,	// 129-144
			229,234,239,244,250,255																// 145-150
		};
	  #endif
	#endif
		
//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------
#elif OUT_CHANNELS == 3		// Triple Channel
//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------
	#ifdef TRIPLE_3_7135			// 3 7135's
		#define RAMP_SIZE  150

		#define TIMED_STEPDOWN_MIN 136
		// min level in ramping the timed stepdown will engage,
		//    level 136 = 130 PWM on the FET, this is ~50%
		#define TIMED_STEPDOWN_SET 130
		// the level timed stepdown will set,
		//    level 129 = 71 PWM, this is ~32%

		#define BANK_START_LVL 71
		#define FET_START_LVL 121

		// Ramping Modes, 150 total entries (2.4 secs)

		//  level_calc.py 3 150 7135 3 0.3 150 7135 3 1.0 500 FET 1 1 1200
		//  Manual changes: edited to add 255 max entries without an overlap,
		//         v1.4: changed 1st level of 7135 bank from 4 to 5 (71st value)
		//
		PROGMEM const byte ramp_7135[] = {
			3,3,3,4,4,4,5,5,						5,6,7,7,8,9,9,10,
			11,12,14,15,16,17,19,21,			22,24,26,28,30,32,35,37,
			40,42,45,48,51,55,58,62,			65,69,73,77,82,86,91,96,
			101,106,111,117,122,128,134,141,	147,154,161,168,175,182,190,198,
			206,215,223,232,243,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,	// 70 entries, 0-69
			255,255,255,255,255,0
		};
		PROGMEM const byte ramp_7135s[] = {

			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,5,7,						10,13,16,19,23,26,30,33,
			37,40,44,48,52,56,60,64,			69,73,78,82,87,92,96,101,
			106,111,117,122,127,133,139,144,	150,156,162,168,174,181,187,194,
			201,207,214,221,228,236,245,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,	// 50 entries, 70-119
			255,255,255,255,255,0
		};
		PROGMEM const byte ramp_FET[]  = {

			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						3,10,17,25,32,40,47,55,
			63,71,79,87,95,104,112,121,		130,139,148,157,166,175,185,194,	// 30 entries, 120-149
			204,214,224,234,245,255
		};
	#endif

	//---------------------------------------------------------------------------------------
	
	#ifdef TRIPLE_8_7135
		#define RAMP_SIZE 150

		#define TIMED_STEPDOWN_MIN 135
		// min level in ramping the timed stepdown will engage,
		//    level 135 = 130 PWM, this is ~50%
		#define TIMED_STEPDOWN_SET 126
		// the level timed stepdown will set,
		//    level 126 = 71 PWM, this is ~32%
		
		#define BANK_START_LVL 63
		#define FET_START_LVL 113

		// Ramping Modes, 150 total entries (2.4 secs)
		//   manually edited, provided by Lexel
		PROGMEM const byte ramp_7135[] = {	// 63 entries, 0-62 
						 3,3,3,4,4,4,5,5,						5,6,6,7,7,8,8,9,
						10,11,12,14,16,18,20,22,			25,28,31,34,37,41,45,49,
						53,57,61,66,71,76,81,86,			92,98,104,110,116,125,132,139,
						146,153,161,169,177,185,194,203,	212,221,231,241,251,255,255,255, 
						255,255,255,255,255,255,255,255, 255,255,255,255,255,255,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,0
		};
		PROGMEM const byte ramp_7135s[] = {	// 50 entries, 63-112
						0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,						0,0,0,0,0,5,7,10,
						13,16,19,23,26,30,33,37,			40,44,48,52,56,60,64,69,
						73,78,82,87,92,96,101,106,			111,117,122,127,133,139,144,150,
						156,162,168,174,181,187,194,201,	207,214,221,228,236,245,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
						255,255,255,255,255,0
		};
		PROGMEM const byte ramp_FET[] = {	// 36 entries, 113-149 
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,0,0,
						0,0,0,0,0,0,0,0,					0,0,0,0,0,0,5,7,
						10,14,17,20,24,28,32,36,		40,45,50,55,60,65,71,77,
						83,89,95,102,109,116,123,130,	138,146,154,162,170,179,188,197,
						206,215,225,235,245,255
		};
	#endif
	
	
	#ifdef OLD_TRIPLE_8_7135
		#define RAMP_SIZE  150

		#define TIMED_STEPDOWN_MIN 115
		// min level in ramping the timed stepdown will engage,
		//    level 115 = 106 PWM, this is ~43%
		#define TIMED_STEPDOWN_SET 102
		// the level timed stepdown will set,
		//    level 102 = 71 PWM, this is ~32%

		#define BANK_START_LVL 71
		#define FET_START_LVL 139

		// Ramping Modes, 150 total entries (2.4 secs)

		//  level_calc.py 3 150 7135 3 0.3 150 7135 3 2.0 800 FET 1 1 1200
		//  (manually edited to add 255 max entries without an overlap)
		PROGMEM const byte ramp_7135[] = {
			3,3,3,4,4,4,5,5,						5,6,7,7,8,9,9,10,
			11,12,14,15,16,17,19,21,			22,24,26,28,30,32,35,37,
			40,42,45,48,51,55,58,62,			65,69,73,77,82,86,91,96,
			101,106,111,117,122,128,134,141,	147,154,161,168,175,182,190,198,
			206,215,223,232,243,255,255,255,	255,255,255,255,255,255,255,255,	// 70 entries, 0-69
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,255,255,255,	255,255,255,255,255,255,255,255,
			255,255,255,255,255,0
		};
		PROGMEM const byte ramp_7135s[] = {

			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,5,7,						9,11,13,15,17,19,21,23,		//	changed from: "0,0,0,0,0,0,3,5,  7,9,11,13,15,17,19,21"
			25,27,29,31,33,36,38,41,			44,46,49,52,55,58,61,64,	// changed from: "24,26,28 ..."
			67,71,74,77,80,84,87,91,			95,98,102,106,110,114,118,122,
			126,130,135,139,144,148,153,157,	162,167,172,177,182,187,192,197,
			203,208,214,219,225,231,237,242,	248,255,255,255,255,255,255,255,	// 68 entries, 70-137
			255,255,255,255,255,0
		};
		PROGMEM const byte ramp_FET[]  = {

			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,0,0,0,0,0,0,
			0,0,0,0,0,0,0,0,						0,0,18,38,59,79,100,122,			// 12 entries, 138-149
			143,165,187,209,232,255
		};
	#endif

//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------
#elif OUT_CHANNELS == 1		// single FET or single bank of 7135's
//---------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------
	#define RAMP_SIZE  150
	
	#define TIMED_STEPDOWN_MIN 137
	// min level in ramping the timed step down will engage,
	//    level 137 = 200 PWM, this is ~80%
	#define TIMED_STEPDOWN_SET 105
	// the level timed stepdown will set,
	//    level 105 = 100 PWM, this is ~40%
	
	#define FET_START_LVL 50	// use about 20% for 1 channel


		// For single channel, 7135 bank or FET
		//    level_calc.py 1 150 7135 5 1.0 1500
		//    defines: 1 channel, 150 steps, 7135 type, 5=start PWM value, approx. min 1.0 lumen, max of 1500 lumen
		PROGMEM const byte ramp_1Chan[] = {
			5,5,5,5,5,5,5,5,						5,6,6,6,6,6,6,6,
			6,7,7,7,7,7,8,8,						8,8,9,9,9,9,10,10,
			11,11,11,12,12,13,13,14,			14,15,15,16,16,17,17,18,
			19,19,20,21,22,22,23,24,			25,26,27,27,28,29,30,31,				// 49-64
			32,33,35,36,37,38,39,40,			42,43,44,46,47,49,50,51,
			53,55,56,58,59,61,63,65,			66,68,70,72,74,76,78,80,
			82,84,86,88,91,93,95,98,			100,102,105,107,110,112,115,118,		//  97-112
			121,123,126,129,132,135,138,141,	144,147,150,154,157,160,163,167,		// 113-128
			170,174,177,181,185,188,192,196,	200,204,208,212,216,220,224,228,		// 129-144
			233,237,241,246,250,255																// 145-150
		};


#endif

#endif /* RAMPINGTABLES_H_ */